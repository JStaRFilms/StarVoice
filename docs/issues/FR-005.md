# [FR-005] System Tray Integration

## Labels
`MUS`, `core`, `tauri`, `tray`

## User Story
As a user, I want the app to live in my system tray, so that it's always available without cluttering my taskbar, and I can quickly access settings or quit the app.

## Proposed Solution

### Overview
Implement a system tray icon with a context menu. The app should not show a main window by default - it operates primarily through the tray and keyboard shortcuts.

### Implementation Flow
1. App starts and creates tray icon
2. Tray icon shows current status (ready/recording/processing)
3. Right-click shows context menu
4. Menu items: Start Recording, History, Settings, Quit
5. Left-click shows quick status or history

### Technical Approach

**Rust Backend:**
```rust
// src-tauri/src/tray.rs
use tauri::{
    tray::{TrayIcon, TrayIconBuilder},
    menu::{Menu, MenuItem, PredefinedMenuItem},
};

pub fn create_tray(app: &tauri::App) -> Result<TrayIcon, Box<dyn std::error::Error>> {
    let start_recording = MenuItem::with_id(app, "start_recording", "Start Recording", true, None::<&str>)?;
    let history = MenuItem::with_id(app, "history", "History", true, None::<&str>)?;
    let settings = MenuItem::with_id(app, "settings", "Settings", true, None::<&str>)?;
    let separator = PredefinedMenuItem::separator(app)?;
    let quit = MenuItem::with_id(app, "quit", "Quit", true, None::<&str>)?;
    
    let menu = Menu::with_items(app, &[
        &start_recording,
        &history,
        &settings,
        &separator,
        &quit,
    ])?;
    
    let tray = TrayIconBuilder::new()
        .icon(app.default_window_icon().unwrap().clone())
        .menu(&menu)
        .on_menu_event(|app, event| {
            match event.id.as_ref() {
                "start_recording" => {
                    app.emit("toggle-recording", ());
                }
                "history" => {
                    app.emit("show-history", ());
                }
                "settings" => {
                    app.emit("show-settings", ());
                }
                "quit" => {
                    app.exit(0);
                }
                _ => {}
            }
        })
        .build(app)?;
    
    Ok(tray)
}

// Update tray icon based on status
pub fn update_tray_status(tray: &TrayIcon, status: &str) {
    let icon_path = match status {
        "recording" => "icons/recording.png",
        "processing" => "icons/processing.png",
        _ => "icons/idle.png",
    };
    // Update icon...
}
```

### Key Considerations
- Tray icon should reflect current state (different icons for idle/recording/processing)
- App should start minimized to tray
- Provide tooltip showing current status
- Handle tray icon click on all platforms

## Acceptance Criteria

- [ ] Tray icon appears on app start
- [ ] Right-click shows context menu with all options
- [ ] Menu items: Start Recording, History, Settings, Quit
- [ ] Tray icon changes based on app status (idle/recording/processing)
- [ ] Tooltip shows current status on hover
- [ ] App doesn't show in taskbar (only tray)
- [ ] Clicking "Quit" from menu closes app completely
- [ ] Works on Windows, macOS, and Linux
